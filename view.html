<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>老人急救信息 - 查看</title>
  <style>
    body { font: 16px/1.5 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Microsoft YaHei", sans-serif; padding: 16px; color: #111; background: #fafafa; }
    .card { max-width: 680px; margin: 0 auto; border: 1px solid #e0e0e0; border-radius: 12px; padding: 16px; background: #fff; }
    h1 { font-size: 20px; margin: 0 0 12px; text-align: center; }
    .kv { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px dotted #ddd; gap: 12px; }
    .kv:last-child { border-bottom: none; }
    .k { color: #333; }
    .v { color: #000; font-weight: 600; text-align: right; }
    .sec { margin-top: 10px; font-weight: 700; }
    .tel { letter-spacing: 0.5px; }
    .err { color: #c62828; margin: 12px 0; text-align: center; }
    .hint { color: #666; text-align: center; margin-top: 8px; font-size: 14px; }
  </style>
  <script defer src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const root = document.getElementById('root');
      const hash = location.hash ? location.hash.slice(1) : '';
      if (!hash) {
        root.innerHTML = '<div class="err">没有检测到数据，请从生成页扫码带数据的二维码</div>';
        return;
      }
      try {
        const json = LZString.decompressFromEncodedURIComponent(hash);
        const data = JSON.parse(json || '{}');

        const safe = v => (v && String(v).trim()) || '—';
        const html = `
          <div class="card">
            <h1>【老人急救信息】</h1>
            <div class="kv"><span class="k">姓名</span><span class="v">${safe(data.name)}</span></div>
            <div class="kv"><span class="k">年龄</span><span class="v">${safe(data.age)}</span></div>
            <div class="kv"><span class="k">血型</span><span class="v">${safe(data.blood)}</span></div>
            <div class="kv"><span class="k">过敏史</span><span class="v">${safe(data.allergy)}</span></div>
            <div class="kv"><span class="k">常用药物</span><span class="v">${safe(data.meds)}</span></div>
            <div class="kv"><span class="k">基础疾病</span><span class="v">${safe(data.conditions)}</span></div>
            <div class="kv"><span class="k">住址</span><span class="v">${safe(data.address)}</span></div>

            <div class="sec">紧急联系人1</div>
            <div class="kv"><span class="k">姓名</span><span class="v">${safe(data.c1_name)}</span></div>
            <div class="kv"><span class="k">关系</span><span class="v">${safe(data.c1_relation)}</span></div>
            <div class="kv"><span class="k">电话</span><span class="v tel">${safe(data.c1_phone)}</span></div>

            <div class="sec">紧急联系人2</div>
            <div class="kv"><span class="k">姓名</span><span class="v">${safe(data.c2_name)}</span></div>
            <div class="kv"><span class="k">关系</span><span class="v">${safe(data.c2_relation)}</span></div>
            <div class="kv"><span class="k">电话</span><span class="v tel">${safe(data.c2_phone)}</span></div>

            <div class="hint">本信息由家属填写，救助者请协助联系</div>
          </div>
        `;
        root.innerHTML = html;
      } catch (e) {
        console.error(e);
        root.innerHTML = '<div class="err">数据解析失败，请重新生成二维码</div>';
      }
    });
  </script>
</head>
<body>
  <div id="root"></div>
</body>
</html>
